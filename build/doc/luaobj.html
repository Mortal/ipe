<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Ipelib: Lua bindings for objects and attributes</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="index.html">The Ipe library documentation</a>&nbsp;&raquo&nbsp;<a class="el" href="lua.html">Programming in Lua</a>
  </div>
</div>
<div class="contents">
<h1><a class="anchor" name="luaobj">Lua bindings for objects and attributes </a></h1>The five Ipe objects are <a class="el" href="classipe_1_1_group.html" title="The group object.">ipe::Group</a>, <a class="el" href="classipe_1_1_path.html" title="The path object (polylines, polygons, and generalizations).">ipe::Path</a>, <a class="el" href="classipe_1_1_text.html" title="The text object.">ipe::Text</a>, <a class="el" href="classipe_1_1_image.html" title="The image object.">ipe::Image</a>, and <a class="el" href="classipe_1_1_reference.html" title="The reference object.">ipe::Reference</a>. They can be constructed from Lua as follows:<p>
<div class="fragment"><pre class="fragment">
obj = ipe.Reference(attributes, name, pos)
obj = ipe.Text(attributes, text, pos)          -- Text of type label
obj = ipe.Text(attributes, text, pos, width)   -- Text of type minipage
obj = ipe.Path(attributes, shape)	 
obj = ipe.Group(elements)               -- elements is a table of objects
</pre></div><p>
Here, <code>attributes</code> is a table defining the desired attributes, see below. <code>shape</code> is a table defining a shape, see below.<p>
Objects have the following methods: <div class="fragment"><pre class="fragment">
obj:type()    -- return type as string: group, text, path, image, reference
obj:clone()   -- clone the object

obj:set(property, value, stroke, fill) -- see below
obj:get(property)                -- see below

obj:xml()                        -- return XML representation
obj:matrix()
obj:setMatrix(m)
obj:addToBBox(r, m)

-- text and reference objects only:
v = obj:position()
-- text objects only:
obj:setText(str)
str = obj:text()
-- path objects only:
shape = obj:shape()                      
obj:setShape(shape)            
-- group objects only:
n = obj:count()                  
shape = obj:clip()           -- nil if no clipping
obj:setClip(shape)
-- image objects only:
obj:info()                   -- returns table about bitmap
-- group objects only:
elements = obj:elements()    -- returns table with clones of elements 
</pre></div><h2><a class="anchor" name="luaattributes">
Attributes</a></h2>
Attributes are represented in Lua as follows:<p>
<ul>
<li>Symbolic names are strings</li>
</ul>
<ul>
<li>Absolute string values (e.g. dash style) are strings</li>
</ul>
<ul>
<li>Absolute numeric values are numbers</li>
</ul>
<ul>
<li>Absolute colors are tables with three entries with keys <code>r</code>, <code>g</code>, <code>b</code> </li>
</ul>
<ul>
<li>Boolean values (for <code>minipage</code>, <code>farrow</code>, <code>rarrow</code>) are booleans (but the strings "true" and "false" can be used to set them)</li>
</ul>
<ul>
<li>Transformations, Pinned, Linejoin, Linecap, Fillrule, Horizontal alignment, and Vertical alignment are represented by fixed strings, see table below.</li>
</ul>
The <em>attributes</em> argument to the object constructors is a table defining all desired attributes. Keys in the table are as follows. If a key is not present, the default value is used. <div class="fragment"><pre class="fragment">
pathmode -- "stroked", "strokedfilled", "filled"
stroke   -- symbolic or color
fill     -- symbolic or color
dashstyle -- symbolic or absolute string
pen      -- symbolic or number
farrow   -- boolean
rarrow   -- boolean
farrowshape -- symbolic
rarrowshape -- symbolic
arrowsize  -- symbolic or number
symbolsize -- symbolic or number
symbolshape -- symbolic
textsize   -- symbolic or number
transformableText -- boolean
textstyle  -- symbolic
opacity    -- symbolic
tiling     -- symbolic
minipage   -- boolean	   
width 	   -- number
horizontalAlignment -- "left", "right", "hcenter"
verticalAlignment   -- "bottom", "baseline", "top", "vcenter"
linejoin            -- "normal", "miter", "round", "bevel"
linecap             -- "normal", "butt", "round", "square"
fillrule            -- "normal", "wind", "evenodd"
pinned              -- "none", "horizontal", "vertical", "fixed"
transformations     -- "translations", "rigid", "affine"
</pre></div><h2><a class="anchor" name="luaprop">
Properties</a></h2>
The <em>set()</em> and <em>get()</em> methods allow to access the attributes of objects. The property names are <div class="fragment"><pre class="fragment">
    pen, symbolsize, 
    farrow, rarrow, farrowsize, rarrowsize, farrowshape, rarrowshape, 
    stroke, fill, markshape,
    pathmode, dashstyle, 
    textsize, textstyle, minipage, width, 
    opacity, tiling, gradient, 
    horizontalalignment, verticalalignment,
    linejoin, linecap, fillrule, 
    pinned, transformations, 
</pre></div><p>
It is okay to set a property on objects that do not support them (for instance, "textsize" on a path object). Reading such properties results in an "undefined" return value.<p>
The arguments <em>stroke</em> and <em>fill</em> for <em>set</em> are only used if the property is <code>pathmode</code>. When the pathmode newly adds stroking or filling to an object, then it takes the stroke and/or fill color from this argument.<h2><a class="anchor" name="luashape">
Shape</a></h2>
The geometry of a path object and the clipping path of a group object is an <a class="el" href="classipe_1_1_shape.html" title="A geometric shape, consisting of several (open or closed) subpaths.">ipe::Shape</a>. This is represented in Lua as a pure Lua object, namely an array with one entry per subpath.<p>
Each subpath is again a table with a <code>type</code> field whose value must be one of "ellipse", "closedspline", or "curve".<p>
For an ellipse, element 1 of the table is the matrix.<p>
For a closed spline, the table contains the control points.<p>
For a curve, the table has a second field <code>closed</code>, which is either <code>true</code> or <code>false</code>. The table also has an entry for each segment of the curve. Each segment is again a table with a <code>type</code> field, whose value is one of "arc", "segment", "quad", "bezier", or "spline". The segment table contains the control points of the segment. For arc segments, there is an additional <code>arc</code> field in the segment table that contains the arc as an <a class="el" href="classipe_1_1_arc.html" title="An arc of an ellipse.">ipe.Arc</a> object. </div>
<hr>
</body></html>
